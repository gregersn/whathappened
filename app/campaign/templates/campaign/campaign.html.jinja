{% extends 'base.html.jinja' %}
{% block head %}
    {{ super() }}
    {% assets "scss_campaign" %}
    <link rel=stylesheet type=text/css href="{{ ASSET_URL }}">
    {% endassets %}
    {{ webpack['campaign.js'] }}
{% endblock %}

{% block header %}
  <h2>{% block title %}{{ campaign.title }}{% endblock %}</h2>
{% endblock %}

{% block menu %}
    {% if editable %}
        <a href="{{ url_for('campaign.edit', id=campaign.id) }}">Edit</a> 
        | 
        <a class="action" href="{{url_for('userassets.index')}}">Assets</a>
    {% endif %}
    {% if current_user.profile in campaign.players %}
        | <a href="">Leave</a>
    {% endif %}
{% endblock %}

{% block content %}
<div class="page">

{%- if campaign.description %}
<section class="description box">
    <div class="markdown">
        {{ campaign.description|markdown }}
    </div>
</section>
{% endif %}

<div class="splitcontainer">
{% if campaign.handouts_enabled %}
{% include 'campaign/campaign_handouts.html.jinja' %}
{% endif %}

{% if campaign.characters_enabled %}
{% include 'campaign/campaign_characters.html.jinja' %}
{% endif %}

{% if campaign.npcs_enabled %}
{% include 'campaign/campaign_npcs.html.jinja' %}
{% endif %}

</div>

{% if editable %}
<div class="splitcontainer">
<section class="players box">
    <h3>Players</h3>
    <div>
    {% if campaign.players %}
        <ul>
        {% for player in campaign.players %}
            <li {%- if player.user == current_user %} class="strong"{%- endif %}>
                {{ player.user.username }}
                {%- if editable %} [<a href="{{ url_for('campaign.remove_player', id=campaign.id, playerid=player.id) }}">Remove</a>]{%- endif %}
            </li>
        {% endfor %}
        </ul>
    {% else %}
        There are no players.
    {% endif %}
    </div>
</section>
<section class="invites box">
    <h3>Share links</h3>
    <div>
        {% if invites %}
         {% for invite in invites %}
            <a href="{{ url_for('campaign.join', code=invite.id) }}">{{ invite.id }}</a> [<a href="">Remove</a>]<br />
         {% endfor %}
        {% endif %}
        <form action="" method="post">
            {{ createinviteform.hidden_tag() }}
            <p>{{ createinviteform.submit() }}</p>
        </form>
    </div>
</section>
{% endif %}
</div>
</div>
{% endblock %}
